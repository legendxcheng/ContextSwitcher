# PySide6 è¿ç§»å¼€å‘è®¡åˆ’

**é¡¹ç›®**: ContextSwitcher GUI æ¡†æ¶è¿ç§»
**ä»**: FreeSimpleGUI
**åˆ°**: PySide6 (Qt for Python)
**åŸå› **: è§£å†³ Windows 11 å…¼å®¹æ€§é—®é¢˜ï¼Œæå‡ç•Œé¢ç¨³å®šæ€§

---

## å½“å‰è¿›åº¦

| é˜¶æ®µ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| é˜¶æ®µ 0ï¼šå‡†å¤‡å·¥ä½œ | âœ… å·²å®Œæˆ | PySide6 å®‰è£…ã€é¡¹ç›®ç»“æ„åˆ›å»ºã€å¯è¡Œæ€§éªŒè¯ |
| é˜¶æ®µ 1ï¼šæ ¸å¿ƒæ¡†æ¶ | âœ… å·²å®Œæˆ | æ— è¾¹æ¡†çª—å£åŸºç±»ã€è‡ªå®šä¹‰æ ‡é¢˜æ ã€ç³»ç»Ÿæ‰˜ç›˜ã€ä»»åŠ¡è¡¨æ ¼ã€æš—è‰²ä¸»é¢˜ |
| é˜¶æ®µ 2ï¼šä¸»çª—å£åŠŸèƒ½ | âœ… å·²å®Œæˆ | ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤ºã€æœç´¢ç­›é€‰ã€æ“ä½œæŒ‰é’®ã€ç•ªèŒ„é’Ÿã€çŠ¶æ€æ  |
| é˜¶æ®µ 3ï¼šå¯¹è¯æ¡†è¿ç§» | ğŸ”„ è¿›è¡Œä¸­ | ä»»åŠ¡ç¼–è¾‘å¯¹è¯æ¡†ã€çª—å£é€‰æ‹©å™¨ã€è®¾ç½®å¯¹è¯æ¡† |
| é˜¶æ®µ 4ï¼šé›†æˆä¼˜åŒ– | â³ å¾…å¼€å§‹ | ä¸»ç¨‹åºæ”¹é€ ã€çƒ­é”®é›†æˆã€æ•°æ®å…¼å®¹ |
| é˜¶æ®µ 5ï¼šæµ‹è¯•æ‰“åŒ… | â³ å¾…å¼€å§‹ | åŠŸèƒ½æµ‹è¯•ã€æ‰“åŒ…é…ç½® |

---

## å·²å®Œæˆå·¥ä½œè¯¦æƒ…

### é˜¶æ®µ 0ï¼šå‡†å¤‡å·¥ä½œ âœ…
- [x] å®‰è£… PySide6 åŠä¾èµ–
- [x] åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„ (`gui/qt/`, `widgets/`, `styles/`)
- [x] éªŒè¯æ— è¾¹æ¡†çª—å£å¯è¡Œæ€§
- [x] éªŒè¯ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½
- [x] éªŒè¯ pynput å…¨å±€çƒ­é”®å…¼å®¹æ€§

### é˜¶æ®µ 1ï¼šæ ¸å¿ƒæ¡†æ¶ âœ…
**æ–°å»ºæ–‡ä»¶**:
```
gui/qt/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ frameless_window.py     # æ— è¾¹æ¡†çª—å£åŸºç±»
â”‚   â”œâ”€â”€ system_tray.py          # ç³»ç»Ÿæ‰˜ç›˜ç»„ä»¶
â”‚   â””â”€â”€ task_table.py           # ä»»åŠ¡è¡¨æ ¼ç»„ä»¶
â””â”€â”€ styles/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ dark_theme.qss           # æš—è‰²ä¸»é¢˜æ ·å¼è¡¨
```

### é˜¶æ®µ 2ï¼šä¸»çª—å£åŠŸèƒ½ âœ…
**æ–°å»ºæ–‡ä»¶**:
- `gui/qt/qt_main_window.py` - ä¸»çª—å£å®ç°

**å·²å®ç°åŠŸèƒ½**:
- ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤ºï¼ˆè¿æ¥ TaskManagerï¼‰
- å®æ—¶æœç´¢ï¼ˆä»»åŠ¡åç§°ã€æè¿°ï¼‰
- çŠ¶æ€ç­›é€‰ï¼ˆå…¨éƒ¨/è¿›è¡Œä¸­/å¾…åŠ/å·²å®Œæˆ/å·²æš‚åœ/å·²é˜»å¡/å¾…å®¡æŸ¥ï¼‰
- æ’åºåŠŸèƒ½ï¼ˆé»˜è®¤/åç§°/çŠ¶æ€/ä»Šæ—¥æ—¶é—´ï¼‰
- æ“ä½œæŒ‰é’®ï¼ˆæ·»åŠ /ç¼–è¾‘/åˆ é™¤/ç»Ÿè®¡/è®¾ç½®ï¼‰
- ç•ªèŒ„é’ŸåŠŸèƒ½ï¼ˆ25åˆ†é’Ÿå€’è®¡æ—¶ï¼‰
- ä»Šæ—¥ä¸“æ³¨æ—¶é—´ç»Ÿè®¡
- çŠ¶æ€æ¶ˆæ¯æ˜¾ç¤º

**çª—å£å°ºå¯¸**: `420x420` (ç´§å‡‘å‹æµ®çª—)

---

## å¾…å¼€å‘å·¥ä½œ

### é˜¶æ®µ 3ï¼šå¯¹è¯æ¡†è¿ç§»

#### 3.1 ä»»åŠ¡ç¼–è¾‘å¯¹è¯æ¡†
- **æ–‡ä»¶**: `gui/qt/qt_task_dialog.py`
- **åŠŸèƒ½**:
  - ä»»åŠ¡åç§°è¾“å…¥
  - ä»»åŠ¡æè¿°è¾“å…¥
  - çŠ¶æ€é€‰æ‹©ä¸‹æ‹‰æ¡†
  - ä¼˜å…ˆçº§é€‰æ‹©
  - çª—å£ç»‘å®šåˆ—è¡¨
  - ä¿å­˜/å–æ¶ˆæŒ‰é’®
- **å‚è€ƒ**: `gui/task_dialog/`

#### 3.2 çª—å£é€‰æ‹©å™¨
- **æ–‡ä»¶**: `gui/qt/qt_window_selector.py`
- **åŠŸèƒ½**:
  - åˆ·æ–°çª—å£åˆ—è¡¨
  - å¤šé€‰æ”¯æŒ
  - å®æ—¶é¢„è§ˆé€‰ä¸­çª—å£
  - Explorer è·¯å¾„æ˜¾ç¤º
- **å‚è€ƒ**: `gui/window_selector.py`

#### 3.3 è®¾ç½®å¯¹è¯æ¡†
- **æ–‡ä»¶**: `gui/qt/qt_settings_dialog.py`
- **åŠŸèƒ½**:
  - çƒ­é”®é…ç½®
  - çª—å£è¡Œä¸ºè®¾ç½®
  - é€šçŸ¥è®¾ç½®
  - æ¯æ—¥ç›®æ ‡è®¾ç½®
- **å‚è€ƒ**: `gui/settings_dialog.py`

#### 3.4 ä»»åŠ¡åˆ‡æ¢å™¨
- **æ–‡ä»¶**: `gui/qt/qt_task_switcher.py`
- **åŠŸèƒ½**:
  - å¤§å°ºå¯¸å¼¹çª—ï¼ˆ800x700ï¼‰
  - é”®ç›˜å¯¼èˆªï¼ˆæ–¹å‘é”®ã€æ•°å­—é”®ï¼‰
  - 2ç§’è‡ªåŠ¨è¶…æ—¶
- **å‚è€ƒ**: `gui/task_switcher_dialog.py`

#### 3.5 æ¬¢è¿å¯¹è¯æ¡†
- **æ–‡ä»¶**: `gui/qt/qt_welcome_dialog.py`
- **åŠŸèƒ½**:
  - é¦–æ¬¡è¿è¡Œå¼•å¯¼
  - å¿«æ·é”®è¯´æ˜
- **å‚è€ƒ**: `gui/welcome_dialog.py`

### é˜¶æ®µ 4ï¼šé›†æˆä¼˜åŒ–

#### 4.1 ä¸»ç¨‹åºå…¥å£æ”¹é€ 
- **æ–‡ä»¶**: `main.py`
- **æ”¹é€ å†…å®¹**:
  - åˆ›å»º QApplication
  - æ ¹æ®ç¯å¢ƒå˜é‡é€‰æ‹© GUI æ¡†æ¶
  - è¿æ¥ä¿¡å·å’Œæ§½

```python
# ä¼ªä»£ç ç¤ºä¾‹
USE_QT = os.environ.get('CONTEXT_SWITCHER_USE_QT', 'false').lower() == 'true'

if USE_QT:
    from gui.qt.qt_main_window import QtMainWindow as MainWindow
    from gui.qt.qt_system_tray import QtSystemTray as SystemTray
else:
    from gui.main_window import MainWindow
    from utils.tray_manager import TrayManager as SystemTray
```

#### 4.2 çƒ­é”®ç®¡ç†é›†æˆ
- ç¡®ä¿ pynput ä¸ Qt äº‹ä»¶å¾ªç¯å…¼å®¹
- çƒ­é”®è§¦å‘æ—¶æ˜¾ç¤ºä»»åŠ¡åˆ‡æ¢å™¨

#### 4.3 æ•°æ®å…¼å®¹
- ä¿æŒé…ç½®æ–‡ä»¶æ ¼å¼ä¸å˜
- ä¿æŒæ•°æ®æ–‡ä»¶æ ¼å¼ä¸å˜
- çª—å£ä½ç½®æ•°æ®å…±äº«

### é˜¶æ®µ 5ï¼šæµ‹è¯•æ‰“åŒ…

#### 5.1 åŠŸèƒ½æµ‹è¯•
- æ‰‹åŠ¨æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- å¤šæ˜¾ç¤ºå™¨æµ‹è¯•
- Windows 10/11 å…¼å®¹æ€§æµ‹è¯•

#### 5.2 æ‰“åŒ…é…ç½®
- æ›´æ–° `ContextSwitcher.spec`
- æˆ–ä½¿ç”¨ `pyside6-deploy`
- å›¾æ ‡å’Œå…ƒæ•°æ®è®¾ç½®

---

## æ–‡ä»¶ç»“æ„ï¼ˆæœ€ç»ˆï¼‰

```
gui/
â”œâ”€â”€ qt/                                    # PySide6 å®ç°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ qt_main_window.py              # ä¸»çª—å£ âœ…
â”‚   â”œâ”€â”€ qt_task_dialog.py              # ä»»åŠ¡ç¼–è¾‘å¯¹è¯æ¡† ğŸ”„
â”‚   â”œâ”€â”€ qt_window_selector.py          # çª—å£é€‰æ‹©å™¨ ğŸ”„
â”‚   â”œâ”€â”€ qt_settings_dialog.py          # è®¾ç½®å¯¹è¯æ¡† ğŸ”„
â”‚   â”œâ”€â”€ qt_task_switcher.py            # ä»»åŠ¡åˆ‡æ¢å™¨ ğŸ”„
â”‚   â”œâ”€â”€ qt_welcome_dialog.py           # æ¬¢è¿å¯¹è¯æ¡† ğŸ”„
â”‚   â”œâ”€â”€ qt_system_tray.py               # ç³»ç»Ÿæ‰˜ç›˜ âœ…
â”‚   â”œâ”€â”€ widgets/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ frameless_window.py        # æ— è¾¹æ¡†çª—å£åŸºç±» âœ…
â”‚   â”‚   â”œâ”€â”€ custom_title_bar.py        # è‡ªå®šä¹‰æ ‡é¢˜æ  âœ…
â”‚   â”‚   â”œâ”€â”€ system_tray.py             # ç³»ç»Ÿæ‰˜ç›˜ âœ…
â”‚   â”‚   â””â”€â”€ task_table.py              # ä»»åŠ¡è¡¨æ ¼ âœ…
â”‚   â””â”€â”€ styles/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ dark_theme.qss             # æš—è‰²ä¸»é¢˜ âœ…
â”‚       â””â”€â”€ light_theme.qss            # äº®è‰²ä¸»é¢˜ï¼ˆå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ main_window.py                       # FreeSimpleGUI ç‰ˆæœ¬ï¼ˆä¿ç•™å…¼å®¹ï¼‰
â”œâ”€â”€ task_switcher_dialog.py              # FreeSimpleGUI ç‰ˆæœ¬ï¼ˆä¿ç•™å…¼å®¹ï¼‰
â”œâ”€â”€ ... (å…¶ä»–ç°æœ‰æ–‡ä»¶)
```

---

## å¼€å‘è§„èŒƒ

### å‘½åçº¦å®š
- PySide6 ç‰ˆæœ¬æ–‡ä»¶å‰ç¼€: `qt_`
- ç±»å: `Qt` å¼€å¤´ï¼ˆå¦‚ `QtMainWindow`, `QtTaskDialog`ï¼‰
- ä¿¡å·å‘½å: `past_tense` (å¦‚ `task_selected`, `add_task_requested`)

### æ ·å¼è§„èŒƒ
- ä½¿ç”¨ QSS æ ·å¼è¡¨å®šä¹‰ UI æ ·å¼
- é¢œè‰²ä½¿ç”¨ `#` åå…­è¿›åˆ¶æ ¼å¼
- å­—ä½“ä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿé»˜è®¤: "Segoe UI", "Microsoft YaHei UI"

### äº‹ä»¶å¤„ç†è§„èŒƒ
- ä½¿ç”¨ Qt ä¿¡å·/æ§½æœºåˆ¶
- çº¿ç¨‹å®‰å…¨: ä»å¤–éƒ¨çº¿ç¨‹è°ƒç”¨æ—¶ä½¿ç”¨ `QMetaObject.invokeMethod` æˆ– ä¿¡å·

---

## ä¾èµ–å˜æ›´

### requirements.txt å˜æ›´
```diff
- FreeSimpleGUI>=5.2.0
+ PySide6>=6.6.0
- pystray>=0.19.5  # ç§»é™¤ï¼Œä½¿ç”¨ Qt å†…ç½®æ‰˜ç›˜
```

---

## é£é™©ä¸ç¼“è§£

| é£é™© | ç¼“è§£æªæ–½ |
|------|----------|
| Qt ä¸ pynput å†²çª | é˜¶æ®µ 0 å·²éªŒè¯å…¼å®¹ï¼Œä½¿ç”¨ä¿¡å·è·¨çº¿ç¨‹é€šä¿¡ |
| æ‰“åŒ…ä½“ç§¯å¢å¤§ | ä½¿ç”¨ pyside6-deploy ä¼˜åŒ–ï¼Œæ’é™¤æœªä½¿ç”¨æ¨¡å— |
| å­¦ä¹ æ›²çº¿ | å‚è€ƒ Qt å®˜æ–¹æ–‡æ¡£å’Œç¤ºä¾‹ä»£ç  |
| æ•°æ®å…¼å®¹ | ä¿ç•™åŸæœ‰æ•°æ®æ ¼å¼ï¼Œåªè¿ç§» UI å±‚ |

---

## å‚è€ƒèµ„æ–™

- [PySide6 å®˜æ–¹æ–‡æ¡£](https://doc.qt.io/qtforpython/)
- [PySide6 System Tray](https://www.pythonguis.com/tutorials/pyside6-system-tray-mac-menu-bar-applications/)
- [PySide6 ç¼–è¯‘æŒ‡å—](https://www.pythonguis.com/tutorials/packaging-pyside6-applications-windows-pyinstaller-installforge/)
- [å…·æœ‰ç°ä»£GUIé£æ ¼çš„PySide6å‚è€ƒé¡¹ç›®](https://www.mr-wu.cn/modern-gui-style-pyside6-pyqt6-reference-project/)

---

**æœ€åæ›´æ–°**: 2025-02-05
**å½“å‰ç‰ˆæœ¬**: v1.0.0
