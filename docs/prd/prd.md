好的，遵照您的要求，这是一份为您量身定制的、完整的、可直接用于开发的最终版产品需求文档。

这份文档整合了我们之前所有的讨论，包括核心理念、窗口绑定等关键功能，并以规范的格式呈现。

-----

### **产品需求文档 (Product Requirements Document)**

**产品名称:** 开发者多任务切换器 (Dev Task Switcher)
**产品版本:** 2.1 (正式版)
**文档状态:** 已定稿
**创建日期:** 2025年7月5日
**最后修订:** 2025年7月5日

-----

### **1. 修订历史**

| **版本号** | **修订日期** | **修订人** | **修订描述** |
| :--- | :--- | :--- | :--- |
| 2.1 | 2025-07-05 | Claude | 风险评估更新：将虚拟桌面功能调整为实验性功能，优化开发策略，确保核心功能稳定性。 |
| 2.0 | 2025-07-05 | Claude | 重大架构升级：采用Python技术栈，实现虚拟桌面功能，支持多窗口任务绑定和完整工作环境切换。 |
| 1.1 | 2025-07-05 | Gemini | 根据核心反馈，新增“任务与窗口绑定”功能，使工具从状态监控器升级为真正的上下文切换器。 |
| 1.0 | 2025-07-05 | Gemini | 创建产品初始需求文档，定义了核心的任务管理、时间戳和快捷键功能。 |

-----

### **2. 产品概述**

#### **2.1 项目背景与问题陈述**

随着大型语言模型（LLM）在编程中的广泛应用，开发者能够以前所未有的效率处理多个并行的开发任务。然而，在这些任务之间频繁切换带来了巨大的心智负担（Cognitive Load）。开发者需要手动使用 `Alt+Tab` 在繁杂的窗口中寻找、切换，并费力回忆每个任务的当前进度和上下文，这严重降低了工作流的流畅性，并可能导致遗忘或混淆。

#### **2.2 产品愿景**

打造一个极简、轻量、由快捷键驱动的Windows桌面小工具。它将作为开发者的“第二大脑”，帮助他们清晰地监管所有并行任务，并通过一键操作**无缝切换工作上下文（包括关联的应用程序窗口）**，从而最大化开发效率和专注度。

#### **2.3 目标用户**

主要面向在日常工作中使用LLM（如ChatGPT, Gemini, Copilot等）辅助编程，并且经常需要同时处理2个或以上开发任务的程序员、软件工程师和技术爱好者。

-----

### **3. 用户画像与使用场景**

#### **3.1 用户画像 (Persona)**

**姓名:** 工程师小张
**角色:** 后端开发者
**目标:** 高效完成每日的开发任务，在多个项目和Bug修复之间保持清晰的思路。
**痛点:**

  * 同时开着VS Code（开发新功能）、浏览器（查资料）、Postman（测试API）、数据库客户端，`Alt+Tab`切换时经常眼花缭乱。
  * 被临时任务打断后，经常忘记之前任务的思路进行到哪一步。
  * 向LLM提问时，需要反复描述当前的任务背景。

#### **3.2 使用场景 (Use Cases)**

  * **场景一：开始工作**
    小张开始一天的工作，打开Dev Task Switcher。他添加了三个任务：“开发用户认证API”、“修复支付模块Bug-123”、“重构日志系统”，并分别将它们绑定到对应的VS Code、浏览器和另一个IDE窗口。
  * **场景二：任务切换**
    小张正在开发API，此时产品经理发来消息，催促他先修复那个紧急的支付Bug。小张按下快捷键 `Ctrl+Alt+2`，屏幕立刻切换到显示支付模块代码的浏览器窗口，同时Dev Task Switcher中该任务的“上次处理时间”被更新。小张立即进入状态，开始修复Bug。
  * **场景三：中断后恢复**
    修复完Bug，小张需要回到API开发。他按下 `Ctrl+Alt+1`，VS Code窗口立即回到前台，他看了一眼任务列表，确认了这就是他之前正在做的工作，无缝衔接，继续开发。

-----

### **4. 功能性需求**

| **功能ID** | **功能名称** | **功能描述** | **验收标准** |
| :--- | :--- | :--- | :--- |
| **F-01** | **主窗口与视图** | 应用是一个独立的Windows窗口，提供简洁的界面来展示所有任务。 | 1. 窗口必须支持“总在最前”（Always-on-Top）。\<br\>2. 用户可以手动调整窗口大小和位置。\<br\>3. 应用能记住关闭前的窗口大小和位置，下次启动时恢复。 |
| **F-02** | **任务列表** | 主窗口中以列表形式清晰展示所有并行任务。 | 1. 列表至少包含三列：“任务名称”、“绑定窗口”和“上次处理时间”。\<br\>2. 列表支持垂直滚动。\<br\>3. 能够高亮显示当前通过快捷键激活的任务。 |
| **F-03** | **添加任务与窗口绑定** | 用户可以快速添加新任务，并将其与一个当前打开的窗口进行绑定。 | 1. 窗口界面上有“[+] 添加任务”按钮。\<br\>2. 点击按钮后，弹出一个对话框。\<br\>3. 对话框内包含：a) “任务名称”的文本输入框；b) 一个下拉菜单，智能过滤并列出当前所有可绑定的窗口标题。\<br\>4. 用户填写任务名，并从下拉菜单中选择一个窗口进行绑定。\<br\>5. 确认后，新任务和其绑定的窗口信息、空的“上次处理时间”一并出现在列表中。 |
| **F-04** | **删除任务** | 用户可以从列表中移除已完成或不再需要的任务。 | 1. 窗口界面上有“[-] 删除任务”按钮或支持选中后按`Delete`键。\<br\>2. 用户首先在列表中选中一个任务，然后执行删除操作。\<br\>3. 删除前应有二次确认弹窗（例如，“确定要删除该任务吗？”）。 |
| **F-05** | **快捷键切换与窗口激活** | **(核心功能)** 用户通过全局快捷键激活特定任务，并自动切换到绑定的窗口。 | 1. 支持设定 `Ctrl + Alt + [数字键1-9]` 作为任务切换的全局快捷键。\<br\>2. 当按下`Ctrl+Alt+N`时，列表中第N个任务的“上次处理时间”自动更新为当前系统时间（格式：`HH:MM:SS` 或 `MM-DD HH:MM`）。\<br\>3. **【关键】** 时间更新后，应用**必须**立即尝试将该任务绑定的窗口激活并显示在最前端。\<br\>4. 如果绑定的窗口已被关闭，则仅更新时间戳，不执行窗口激活，并在“绑定窗口”列中显示“(失效)”或灰色提示。 |
| **F-06** | **数据持久化** | 应用能保存用户的任务列表（包括窗口绑定信息），关闭再打开后数据不丢失。 | 1. 任务列表（名称、窗口标识符和时间戳）在应用关闭时自动保存。\<br\>2. 应用启动时自动加载上次保存的任务列表。\<br\>3. 数据存储在本地用户目录（`%APPDATA%`）下的单个文件（如`tasks.json`）中。 |
| **F-07** | **编辑任务** | 用户可以修改已存在的任务名称或重新绑定窗口。 | 1. 用户可以通过双击或右键菜单中的“编辑”选项打开编辑对话框。\<br\>2. 在编辑对话框中，可以修改任务名称，也可以从当前的窗口列表中重新选择绑定的窗口。 |

-----

### **5. 用户界面与体验 (UI/UX) 设计**

  * **设计理念**: 极简、高效、信息密度高、无干扰。功能优先，美观其次。
  * **布局草图 (Text Wireframe)**:
    ```
    +-----------------------------------------------------------+
    | Dev Task Switcher v1.1                     [ _ ] [ □ ] [ X ]|
    +-----------------------------------------------------------+
    | 任务名称                 | 绑定窗口             | 上次处理 |
    |--------------------------|----------------------|------------|
    | ▶ 开发用户认证API        | [VS Code] MyApp      | 13:05:12   |
    |   修复支付模块Bug-123    | [Chrome] JIRA-456    | 11:45:30   |
    |   重构日志系统           | [IDEA] logging-svc   | (失效)     |
    |                          |                      |            |
    |                          |                      |            |
    +-----------------------------------------------------------+
    | [ + 添加任务 ]  [ - 删除任务 ]  [ 编辑任务 ]                 |
    +-----------------------------------------------------------+
    ```
      * `▶` 指示当前激活的任务。
      * `(失效)` 指示绑定的窗口已关闭。

-----

### **6. 非功能性需求**

| 类别 | 需求描述 |
| :--- | :--- |
| **性能** | 1. 应用冷启动时间 \< 5秒（Python语言特性）。\<br\>2. 运行时CPU占用率 \< 2%，内存占用 \< 150MB。\<br\>3. 全局快捷键响应时间 \< 100毫秒（虚拟桌面切换）。 |
| **平台兼容性** | Windows 10, Windows 11。 |
| **稳定性** | 应用7x24小时运行不崩溃。窗口绑定机制失效后能优雅处理，不影响应用核心功能。 |
| **易用性** | 无需说明文档即可上手。 |

-----

### **7. 功能优先级规划**

  * **智能重新绑定**: 当发现一个任务绑定的窗口失效时，激活该任务可提示用户重新绑定。
  * **高级复制功能**: 增加一个快捷键，用于将“任务名称”和预设的LLM提示模板组合后复制到剪贴板。
  * **任务状态管理**: 增加“状态”列（如：待办、进行中、已阻塞）。
  * **简易计时器**: 统计每个任务今日的累计专注时长。
  * **任务排序**: 允许用户通过拖拽来调整任务在列表中的顺序。

-----

### **8. 技术架构与依赖**

#### **8.1 技术栈**
  * **开发语言**: Python 3.11+
  * **GUI框架**: PySide6 或 PyQt6
  * **系统集成**: pywin32（Windows API调用）
  * **虚拟桌面**: pyvda库（Windows Virtual Desktop API）
  * **全局热键**: global-hotkeys库

#### **8.2 系统依赖**
  * **操作系统**: Windows 10 版本 1903+（支持虚拟桌面）
  * **Python运行时**: Python 3.11 或更高版本
  * **权限要求**: 标准用户权限（无需管理员权限）

#### **8.3 假设与限制**
  * **假设**: 用户工作环境允许运行第三方桌面应用，并具备设置权限。
  * **技术限制**: 虚拟桌面API依赖未公开的Windows COM接口，存在高风险，可能在系统更新后失效。
  * **兼容性**: 仅支持Windows 10/11，不兼容旧版本系统。
  * **开发策略**: 虚拟桌面功能作为实验性功能，核心功能不依赖此API。

-----

### **9. 成功指标**

  * **核心指标**: 开发者本人在无强制要求的情况下，连续使用该工具超过一周。
  * **效率指标**: 用户主观感受，在多任务处理时，心智负担明显降低，上下文切换速度显著提升。
  * **行为指标**: 用户日均通过快捷键切换任务的次数 \> 10次。